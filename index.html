<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Data Dashboard - Professional Analytics Platform</title>
    
    <!-- CSS Libraries -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Chart Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    
    <!-- Data Processing Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <i class="fas fa-chart-line"></i>
            <h2>Data Dashboard</h2>
        </div>
        
        <nav class="sidebar-nav">
            <a href="#" class="nav-item active" data-page="upload">
                <i class="fas fa-cloud-upload-alt"></i>
                <span>Upload Data</span>
            </a>
            <a href="#" class="nav-item" data-page="preview">
                <i class="fas fa-table"></i>
                <span>Data Preview</span>
            </a>
            <a href="#" class="nav-item" data-page="visualizations">
                <i class="fas fa-chart-bar"></i>
                <span>Visualizations</span>
            </a>
            <a href="#" class="nav-item" data-page="pivot">
                <i class="fas fa-th"></i>
                <span>Pivot Tables</span>
            </a>
            <a href="#" class="nav-item" data-page="auto-report">
                <i class="fas fa-file-alt"></i>
                <span>Auto Report</span>
            </a>
            <a href="#" class="nav-item" data-page="insights">
                <i class="fas fa-lightbulb"></i>
                <span>Insights</span>
            </a>
        </nav>
        
        <div class="sidebar-footer">
            <button class="btn-secondary" id="clearDataBtn">
                <i class="fas fa-trash"></i> Clear All Data
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="header">
            <button class="mobile-menu-toggle" id="mobileMenuToggle">
                <i class="fas fa-bars"></i>
            </button>
            <h1 class="page-title" id="pageTitle">Upload Data</h1>
            <div class="header-actions">
                <button class="btn-icon" id="themeToggle" title="Toggle Dark Mode">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </header>

        <!-- Page: Upload Data -->
        <section class="page active" id="uploadPage">
            <div class="container">
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-upload"></i> Upload CSV / Excel Files</h2>
                    </div>
                    <div class="card-body">
                        <div class="upload-zone" id="uploadZone">
                            <i class="fas fa-cloud-upload-alt upload-icon"></i>
                            <h3>Drop files here or click to browse</h3>
                            <p>Supports CSV, XLSX, XLS files</p>
                            <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" multiple hidden>
                        </div>
                        
                        <div id="fileList" class="file-list"></div>
                        
                        <div class="upload-options" id="uploadOptions" style="display: none;">
                            <div class="form-group">
                                <label>Merge Strategy</label>
                                <select id="mergeStrategy" class="form-control">
                                    <option value="append">Append (Stack all files)</option>
                                    <option value="inner_join">Inner Join</option>
                                </select>
                            </div>
                            
                            <div class="form-group" id="joinKeyGroup" style="display: none;">
                                <label>Join Key Column</label>
                                <input type="text" id="joinKey" class="form-control" placeholder="e.g., id">
                            </div>
                            
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="dedupeCheck" checked>
                                    Remove duplicate rows
                                </label>
                            </div>
                            
                            <button class="btn-primary" id="processFilesBtn">
                                <i class="fas fa-cogs"></i> Process Files
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="uploadResults" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h3>Upload Results</h3>
                        </div>
                        <div class="card-body">
                            <div class="stats-grid" id="uploadStats"></div>
                            <button class="btn-success" id="proceedBtn">
                                <i class="fas fa-arrow-right"></i> Proceed to Analysis
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Page: Data Preview -->
        <section class="page" id="previewPage">
            <div class="container">
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-table"></i> Data Preview</h2>
                        <div class="header-actions">
                            <button class="btn-secondary" id="exportCSV">
                                <i class="fas fa-download"></i> Export CSV
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="data-info" id="dataInfo"></div>
                        <div class="table-container">
                            <table class="data-table" id="previewTable">
                                <thead id="previewTableHead"></thead>
                                <tbody id="previewTableBody"></tbody>
                            </table>
                        </div>
                        <div class="pagination" id="previewPagination"></div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Column Statistics</h3>
                    </div>
                    <div class="card-body">
                        <div id="columnStats" class="stats-grid"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Page: Visualizations -->
        <section class="page" id="visualizationsPage">
            <div class="container">
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-chart-bar"></i> Advanced Visualization Builder</h2>
                    </div>
                    <div class="card-body">
                        <div class="viz-builder">
                            <!-- Chart Library Selection -->
                            <div class="form-section">
                                <h3>Step 1: Choose Chart Library</h3>
                                <div class="radio-group">
                                    <label class="radio-card">
                                        <input type="radio" name="chartLibrary" value="chartjs" checked>
                                        <div class="radio-content">
                                            <i class="fas fa-chart-pie"></i>
                                            <strong>Chart.js</strong>
                                            <span>Fast, responsive charts</span>
                                        </div>
                                    </label>
                                    <label class="radio-card">
                                        <input type="radio" name="chartLibrary" value="echarts">
                                        <div class="radio-content">
                                            <i class="fas fa-chart-area"></i>
                                            <strong>ECharts</strong>
                                            <span>Advanced & interactive</span>
                                        </div>
                                    </label>
                                    <label class="radio-card">
                                        <input type="radio" name="chartLibrary" value="plotly">
                                        <div class="radio-content">
                                            <i class="fas fa-chart-line"></i>
                                            <strong>Plotly</strong>
                                            <span>Scientific & statistical</span>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <!-- Column Selection -->
                            <div class="form-section">
                                <h3>Step 2: Select Data Columns</h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>X-Axis Column</label>
                                        <select id="xAxisColumn" class="form-control"></select>
                                    </div>
                                    <div class="form-group">
                                        <label>Y-Axis Column(s)</label>
                                        <select id="yAxisColumn" class="form-control" multiple></select>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Group By (Optional)</label>
                                        <select id="groupByColumn" class="form-control">
                                            <option value="">None</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Color By (Optional)</label>
                                        <select id="colorByColumn" class="form-control">
                                            <option value="">None</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Chart Type Selection -->
                            <div class="form-section">
                                <h3>Step 3: Chart Type</h3>
                                <div class="chart-type-grid">
                                    <label class="chart-type-card">
                                        <input type="radio" name="chartType" value="line" checked>
                                        <div class="chart-type-content">
                                            <i class="fas fa-chart-line"></i>
                                            <span>Line Chart</span>
                                        </div>
                                    </label>
                                    <label class="chart-type-card">
                                        <input type="radio" name="chartType" value="bar">
                                        <div class="chart-type-content">
                                            <i class="fas fa-chart-bar"></i>
                                            <span>Bar Chart</span>
                                        </div>
                                    </label>
                                    <label class="chart-type-card">
                                        <input type="radio" name="chartType" value="scatter">
                                        <div class="chart-type-content">
                                            <i class="fas fa-braille"></i>
                                            <span>Scatter Plot</span>
                                        </div>
                                    </label>
                                    <label class="chart-type-card">
                                        <input type="radio" name="chartType" value="pie">
                                        <div class="chart-type-content">
                                            <i class="fas fa-chart-pie"></i>
                                            <span>Pie Chart</span>
                                        </div>
                                    </label>
                                    <label class="chart-type-card">
                                        <input type="radio" name="chartType" value="area">
                                        <div class="chart-type-content">
                                            <i class="fas fa-chart-area"></i>
                                            <span>Area Chart</span>
                                        </div>
                                    </label>
                                    <label class="chart-type-card">
                                        <input type="radio" name="chartType" value="radar">
                                        <div class="chart-type-content">
                                            <i class="fas fa-spider"></i>
                                            <span>Radar Chart</span>
                                        </div>
                                    </label>
                                    <label class="chart-type-card">
                                        <input type="radio" name="chartType" value="heatmap">
                                        <div class="chart-type-content">
                                            <i class="fas fa-th"></i>
                                            <span>Heatmap</span>
                                        </div>
                                    </label>
                                    <label class="chart-type-card">
                                        <input type="radio" name="chartType" value="box">
                                        <div class="chart-type-content">
                                            <i class="fas fa-box"></i>
                                            <span>Box Plot</span>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <!-- Advanced Options -->
                            <div class="form-section collapsible">
                                <h3 class="collapsible-header">
                                    <i class="fas fa-sliders-h"></i> Step 4: Advanced Options
                                    <i class="fas fa-chevron-down"></i>
                                </h3>
                                <div class="collapsible-content">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Aggregation Function</label>
                                            <select id="aggFunction" class="form-control">
                                                <option value="none">None</option>
                                                <option value="sum">Sum</option>
                                                <option value="mean">Average</option>
                                                <option value="count">Count</option>
                                                <option value="min">Minimum</option>
                                                <option value="max">Maximum</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>Sort By</label>
                                            <select id="sortBy" class="form-control">
                                                <option value="">No Sorting</option>
                                                <option value="x-asc">X-Axis Ascending</option>
                                                <option value="x-desc">X-Axis Descending</option>
                                                <option value="y-asc">Y-Axis Ascending</option>
                                                <option value="y-desc">Y-Axis Descending</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Chart Title</label>
                                            <input type="text" id="chartTitle" class="form-control" placeholder="Enter chart title">
                                        </div>
                                        <div class="form-group">
                                            <label>Color Scheme</label>
                                            <select id="colorScheme" class="form-control">
                                                <option value="default">Default</option>
                                                <option value="pastel">Pastel</option>
                                                <option value="vibrant">Vibrant</option>
                                                <option value="monochrome">Monochrome</option>
                                                <option value="gradient">Gradient</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="checkbox-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="showLegend" checked>
                                            Show Legend
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="showGrid" checked>
                                            Show Grid
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="showDataLabels">
                                            Show Data Labels
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="enableAnimation" checked>
                                            Enable Animation
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="smoothLines">
                                            Smooth Lines (Line Charts)
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="stackedMode">
                                            Stacked Mode (Bar/Area)
                                        </label>
                                    </div>
                                    
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Data Limit (Top N)</label>
                                            <input type="number" id="dataLimit" class="form-control" value="50" min="5" max="1000">
                                        </div>
                                        <div class="form-group">
                                            <label>Chart Height (px)</label>
                                            <input type="number" id="chartHeight" class="form-control" value="500" min="300" max="1000">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Filters -->
                            <div class="form-section collapsible">
                                <h3 class="collapsible-header">
                                    <i class="fas fa-filter"></i> Data Filters
                                    <i class="fas fa-chevron-down"></i>
                                </h3>
                                <div class="collapsible-content" id="filterContainer">
                                    <p class="text-muted">Add filters to refine your data</p>
                                    <button class="btn-secondary" id="addFilterBtn">
                                        <i class="fas fa-plus"></i> Add Filter
                                    </button>
                                    <div id="filtersList"></div>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button class="btn-primary btn-lg" id="generateChartBtn">
                                    <i class="fas fa-chart-line"></i> Generate Chart
                                </button>
                                <button class="btn-secondary" id="saveChartBtn" style="display: none;">
                                    <i class="fas fa-save"></i> Save Chart
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chart Display -->
                <div class="card" id="chartCard" style="display: none;">
                    <div class="card-header">
                        <h3 id="displayedChartTitle">Generated Chart</h3>
                        <div class="header-actions">
                            <button class="btn-icon" id="downloadChartBtn" title="Download as PNG">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="btn-icon" id="fullscreenChartBtn" title="Fullscreen">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="chartContainer" style="height: 500px;"></div>
                    </div>
                </div>

                <!-- Saved Charts Gallery -->
                <div class="card" id="savedChartsCard" style="display: none;">
                    <div class="card-header">
                        <h3><i class="fas fa-images"></i> Saved Charts</h3>
                    </div>
                    <div class="card-body">
                        <div id="savedChartsGallery" class="charts-gallery"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Page: Pivot Tables -->
        <section class="page" id="pivotPage">
            <div class="container">
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-th"></i> Smart Pivot Table Builder</h2>
                    </div>
                    <div class="card-body">
                        <div class="pivot-builder">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Row Fields</label>
                                    <select id="pivotRows" class="form-control" multiple></select>
                                </div>
                                <div class="form-group">
                                    <label>Column Fields</label>
                                    <select id="pivotCols" class="form-control" multiple></select>
                                </div>
                                <div class="form-group">
                                    <label>Value Fields</label>
                                    <select id="pivotValues" class="form-control" multiple></select>
                                </div>
                                <div class="form-group">
                                    <label>Aggregation</label>
                                    <select id="pivotAgg" class="form-control">
                                        <option value="sum">Sum</option>
                                        <option value="mean">Average</option>
                                        <option value="count">Count</option>
                                        <option value="min">Min</option>
                                        <option value="max">Max</option>
                                    </select>
                                </div>
                            </div>
                            <button class="btn-primary" id="generatePivotBtn">
                                <i class="fas fa-table"></i> Generate Pivot Table
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card" id="pivotResultCard" style="display: none;">
                    <div class="card-header">
                        <h3>Pivot Table Result</h3>
                        <div class="header-actions">
                            <button class="btn-secondary" id="exportPivotBtn">
                                <i class="fas fa-download"></i> Export
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-container" id="pivotTableContainer"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Page: Auto Report -->
        <section class="page" id="autoReportPage">
            <div class="container">
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-file-alt"></i> Automated Report Generator</h2>
                    </div>
                    <div class="card-body">
                        <button class="btn-primary btn-lg" id="generateReportBtn">
                            <i class="fas fa-magic"></i> Generate Auto Report
                        </button>
                        <div id="reportContent" style="display: none;"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Page: Insights -->
        <section class="page" id="insightsPage">
            <div class="container">
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-lightbulb"></i> Data Insights & Analytics</h2>
                    </div>
                    <div class="card-body">
                        <div id="insightsContent">
                            <button class="btn-primary" id="analyzeDataBtn">
                                <i class="fas fa-brain"></i> Analyze Dataset
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card" id="correlationCard" style="display: none;">
                    <div class="card-header">
                        <h3>Correlation Matrix</h3>
                    </div>
                    <div class="card-body">
                        <div id="correlationMatrix" style="height: 500px;"></div>
                    </div>
                </div>

                <div class="card" id="statisticsCard" style="display: none;">
                    <div class="card-header">
                        <h3>Statistical Summary</h3>
                    </div>
                    <div class="card-body">
                        <div id="statisticsSummary"></div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <p>Processing data...</p>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Scripts -->
    <script src="utils.js"></script>
    <script src="dataProcessor.js"></script>
    <script src="chartBuilder.js"></script>
    <script src="pivotTable.js"></script>
    <script src="insights.js"></script>
    <script src="main.js"></script>
</body>
</html>
